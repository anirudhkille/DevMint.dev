"use client";

import * as React from "react";
import Link from "next/link";
import { Button } from "@/components/ui/button";
import { SearchCommand } from "./search-command";
import { MobileSidebar } from "./mobile-sidebar";
import { Github } from "lucide-react";
import { ThemeToggle } from "@/components/theme-toggle";

export function Header() {
  const [searchOpen, setSearchOpen] = React.useState(false);

  React.useEffect(() => {
    const down = (e: KeyboardEvent) => {
      if (e.key === "k" && (e.metaKey || e.ctrlKey)) {
        e.preventDefault();
        setSearchOpen((open) => !open);
      }
    };
    document.addEventListener("keydown", down);
    return () => document.removeEventListener("keydown", down);
  }, []);

  return (
    <>
      <header className="border-border bg-background/95 supports-backdrop-filter:bg-background/60 sticky top-0 z-50 w-full border-b backdrop-blur">
        <div className="container flex h-14 items-center px-4 md:px-6">
          <MobileSidebar />

          <div className="flex items-center gap-6 md:gap-8">
            <Link href="/" className="flex items-center font-semibold">
              <div className="flex h-10 w-10 items-center justify-center">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="48"
                  height="48"
                  viewBox="-550 -50 800 450"
                  fill="currentColor"
                >
                  <path d="M0 0 C1.37966024 5.20100578 2.39852164 10.23085707 3.03515625 15.5859375 C3.11873886 16.28659332 3.20232147 16.98724915 3.28843689 17.70913696 C3.46317588 19.18616015 3.63530779 20.66349392 3.80493164 22.14111328 C4.05800091 24.33597945 4.32230313 26.52927416 4.58789062 28.72265625 C12.67648469 96.93384949 8.69121022 172.07452676 -35 228.3125 C-71.46265244 272.18747809 -121.07160174 293.302749 -177 300 C-177.84739746 300.10602539 -178.69479492 300.21205078 -179.56787109 300.32128906 C-187.91856468 301.23356325 -196.29118968 301.15127243 -204.68066406 301.13037109 C-207.25852255 301.12498218 -209.83620909 301.13035972 -212.4140625 301.13671875 C-214.07291705 301.13605836 -215.73177149 301.13477802 -217.390625 301.1328125 C-218.53147552 301.13584885 -218.53147552 301.13584885 -219.69537354 301.13894653 C-224.22959675 301.11922594 -228.5255706 300.74278774 -233 300 C-231.28608409 296.01392129 -228.62499578 292.79812813 -225.9375 289.4375 C-225.19777954 288.50550781 -225.19777954 288.50550781 -224.44311523 287.5546875 C-222.9669418 285.69917154 -221.4848077 283.84861109 -220 282 C-219.23945313 281.05253906 -218.47890625 280.10507812 -217.6953125 279.12890625 C-209.6500658 269.21232927 -201.36175006 259.4919871 -192.75 250.0625 C-192.29133545 249.55541504 -191.8326709 249.04833008 -191.36010742 248.52587891 C-188.89584279 245.85563936 -186.35157233 243.40705921 -183.58203125 241.0546875 C-177.40132286 235.72838407 -171.72039803 229.86894033 -165.96362305 224.09399414 C-163.94235732 222.0673702 -161.91580426 220.04614453 -159.88867188 218.02539062 C-151.38795195 209.52928607 -151.38795195 209.52928607 -143.3684082 200.58227539 C-141.25824528 198.14231715 -138.94439701 195.92679771 -136.625 193.6875 C-132.14593254 189.29381405 -128.1453147 184.64462699 -124.23828125 179.73828125 C-121.96158439 176.95300289 -119.57415857 174.32179181 -117.125 171.6875 C-112.32609852 166.47194971 -107.97665603 160.99111659 -103.64453125 155.390625 C-101.36971042 152.45357673 -99.01288506 149.59625422 -96.625 146.75 C-81.15967114 127.89991056 -68.11590582 107.11394875 -56 86 C-59.27058977 89.18073645 -62.2161445 92.42564066 -65.02734375 96.015625 C-69.95872375 102.10354682 -75.35257883 107.62246677 -80.9206543 113.12646484 C-82.5694957 114.75691768 -84.21006101 116.3953638 -85.84960938 118.03515625 C-90.86135802 123.02996071 -95.91311192 127.93653614 -101.29418945 132.53710938 C-103.86859614 134.74490168 -106.33088086 137.06344986 -108.8125 139.375 C-113.43433831 143.64519259 -118.19423948 147.68225373 -123.09765625 151.62890625 C-126.38962888 154.31831054 -129.60007982 157.09167086 -132.8125 159.875 C-138.55532924 164.83318254 -144.44402965 169.5634411 -150.43359375 174.21875 C-154.15214338 177.10901657 -157.82796001 180.05099653 -161.5 183 C-165.75001517 186.41317348 -170.01724357 189.80022291 -174.32128906 193.14501953 C-185.632931 201.94754516 -196.41247729 211.34178963 -207 221 C-207.96679688 221.87398437 -208.93359375 222.74796875 -209.9296875 223.6484375 C-218.34783417 231.27977864 -226.59839918 239.0433089 -233.9765625 247.703125 C-235.58372374 249.52747019 -237.21761835 251.29194945 -238.8984375 253.046875 C-246.28364294 260.7787512 -252.90027177 268.80159166 -259.13623047 277.48510742 C-260.61176935 279.47613781 -262.11964718 281.41643738 -263.66455078 283.3527832 C-271.8421305 293.72465285 -277.89700483 304.62804212 -283.75 316.4375 C-284.63795072 318.19665684 -285.52727094 319.9551231 -286.41796875 321.71289062 C-291.80501836 332.38528413 -296.96964262 343.15539082 -302 354 C-311.47042169 352.56964757 -317.13399226 347.281818 -323.46875 340.34375 C-325.42284594 337.35278683 -326.00885923 335.59241769 -326 332 C-324.56487545 329.3507722 -323.17163694 327.19191917 -321.375 324.8125 C-320.35325912 323.39648774 -319.33246598 321.97979127 -318.3125 320.5625 C-317.77109375 319.82128906 -317.2296875 319.08007812 -316.671875 318.31640625 C-313.82442023 314.37121775 -311.10809875 310.33731568 -308.375 306.3125 C-307.28320628 304.71700006 -306.19076979 303.12193975 -305.09765625 301.52734375 C-303.1404768 298.6698255 -301.19004585 295.80793599 -299.24609375 292.94140625 C-298.4350226 291.75251768 -297.62383345 290.56370959 -296.8125 289.375 C-296.11769531 288.35148437 -295.42289063 287.32796875 -294.70703125 286.2734375 C-293 284 -293 284 -291 283 C-291.09087891 282.09161377 -291.18175781 281.18322754 -291.27539062 280.24731445 C-294.72106118 245.1081011 -296.83584154 210.15561992 -286 176 C-285.77973145 175.30471191 -285.55946289 174.60942383 -285.33251953 173.89306641 C-278.40108509 152.64572816 -265.83846728 134.374266 -250.38134766 118.42822266 C-249.15112328 117.15625154 -247.93943172 115.86641497 -246.73046875 114.57421875 C-215.02017917 81.45196822 -170.41086919 66.65982715 -127.29257202 55.21852112 C-84.52098619 43.86738781 -38.92188416 31.61538923 -4.64453125 2.14453125 C-2 0 -2 0 0 0 Z" />
                </svg>
              </div>
              <span className="hidden md:inline-block">DevMint</span>
            </Link>
          </div>

          <div className="ml-12 flex flex-1 items-center justify-end gap-2">
            <Button
              variant="outline"
              className="bg-muted/50 text-muted-foreground relative h-9 w-full justify-start rounded-md text-sm sm:w-64 md:w-80"
              onClick={() => setSearchOpen(true)}
            >
              <span className="hidden lg:inline-flex">Search documentation...</span>
              <span className="inline-flex lg:hidden">Search...</span>
              <kbd className="bg-background pointer-events-none absolute top-1.5 right-1.5 hidden h-6 items-center gap-1 rounded border px-1.5 font-mono text-[10px] font-medium opacity-100 select-none sm:flex">
                <span className="text-xs">âŒ˜</span>K
              </kbd>
            </Button>
            <div className="flex items-center gap-1">
              <ThemeToggle />

              <Button
                variant="ghost"
                size="icon"
                className="hidden h-9 w-9 justify-center md:flex"
                asChild
              >
                <Link
                  href="https://github.com/anirudhkille/devmint.dev"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  <Github className="h-4 w-4" />
                  <span className="sr-only">GitHub</span>
                </Link>
              </Button>
            </div>
          </div>
        </div>
      </header>
      <SearchCommand open={searchOpen} onOpenChange={setSearchOpen} />
    </>
  );
}
